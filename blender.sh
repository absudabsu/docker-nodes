#!/bin/bash
## SUDO CHECK ------------------------------------------------------------------
[ "$UID" -eq 0 ] || exec sudo bash "$0" "$@"
## -----------------------------------------------------------------------------

# source /root/.bash_profile
git clone http://git.blender.org/blender.git
cd blender
git submodule update --init --recursive
git submodule foreach git checkout master
git submodule foreach git pull --rebase origin master

# apt-get -y build-dep blender # need to prune this to disclude python3! as long as python3 is in the path, it will install to that version!
apt-get -y install bsdmainutils debhelper dh-strip-nondeterminism fontconfig fontconfig-config fonts-dejavu-core gettext groff-base intltool-debian libalut-dev libalut0 libarchive-zip-perl libasound2 libasound2-data libasound2-dev libass5 libasyncns0 libatk1.0-0 libatk1.0-data libavahi-client3 libavahi-common-data libavahi-common3 libavc1394-0 libavcodec-dev libavcodec-ffmpeg56 libavdevice-dev libavdevice-ffmpeg56 libavfilter-dev libavfilter-ffmpeg5 libavformat-dev libavformat-ffmpeg56 libavresample-dev libavresample-ffmpeg2 libavutil-dev libavutil-ffmpeg54 libbluray1 libbs2b0 libcaca-dev libcaca0 libcairo2 libcdio-cdda1 libcdio-paranoia1 libcdio13 libcroco3 libcrystalhd3 libcups2 libdatrie1 libdc1394-22 libdrm-amdgpu1 libdrm-dev libdrm-intel1 libdrm-nouveau2 libdrm-radeon1 libdrm2 libelf1 libfftw3-bin libfftw3-dev libfftw3-double3 libfftw3-long3 libfftw3-quad3 libfftw3-single3 libfile-stripnondeterminism-perl libflac-dev libflac8 libflite1 libfontconfig1 libfontconfig1-dev libfreetype6-dev libfribidi0 libgdk-pixbuf2.0-0 libgdk-pixbuf2.0-common libgettextpo-dev libgettextpo0 libgif7 libgl1-mesa-dev libgl1-mesa-dri libgl1-mesa-glx libglapi-mesa libglew-dev libglew1.13 libglib2.0-bin libglib2.0-dev libglu1-mesa libglu1-mesa-dev libgme0 libgraphite2-3 libgsm1 libgsm1-dev libgtk2.0-0 libgtk2.0-common libgtkglext1 libharfbuzz0b libice6 libiec61883-0 libilmbase-dev libilmbase12 libjack-dev libjack0 libjasper1 libjbig-dev libjbig0 libjemalloc-dev libjemalloc1 libjpeg-dev libjpeg-turbo8 libjpeg-turbo8-dev libjpeg8 libjpeg8-dev libjson-c2 liblcms2-2 libllvm3.8 liblzma-dev liblzo2-dev libmodplug1 libmp3lame0 libogg-dev libogg0 libopenal-data libopenal-dev libopenal1 libopencolorio-dev libopencolorio1v5 libopencv-core2.4v5 libopencv-highgui2.4v5 libopencv-imgproc2.4v5 libopenexr-dev libopenexr22 libopenimageio-dev libopenimageio-doc libopenimageio1.6 libopenjpeg-dev libopenjpeg5 libopus0 liborc-0.4-0 libpango-1.0-0 libpangocairo-1.0-0 libpangoft2-1.0-0 libpangox-1.0-0 libpcre16-3 libpcre3-dev libpcre32-3 libpcrecpp0v5 libpipeline1 libpixman-1-0 libpng12-dev libpostproc-dev libpostproc-ffmpeg53 libpthread-stubs0-dev libpulse-dev libpulse-mainloop-glib0 libpulse0   libraw1394-11 libraw15 libschroedinger-1.0-0 libsdl1.2-dev libsdl1.2debian libshine3 libslang2 libslang2-dev libsm6 libsnappy1v5 libsndfile1 libsndfile1-dev libsodium18 libsoxr0 libspeex1 libspnav-dev libspnav0 libssh-gcrypt-4 libswresample-dev libswresample-ffmpeg1 libswscale-dev libswscale-ffmpeg3 libtbb2 libthai-data libthai0 libtheora0 libtiff5 libtiff5-dev libtiffxx5 libtimedate-perl libtinyxml2.6.2v5 libtwolame0 libunistring0 libusb-1.0-0 libv4l-0 libv4lconvert0 libva1 libvorbis-dev libvorbis0a libvorbisenc2 libvorbisfile3 libvpx3 libwavpack1 libwebp5 libwrap0 libx11-dev libx11-xcb-dev libx11-xcb1 libx264-148 libx265-79 libxau-dev libxcb-dri2-0 libxcb-dri2-0-dev libxcb-dri3-0 libxcb-dri3-dev libxcb-glx0 libxcb-glx0-dev libxcb-present-dev libxcb-present0 libxcb-randr0 libxcb-randr0-dev libxcb-render0 libxcb-render0-dev libxcb-shape0 libxcb-shape0-dev libxcb-shm0 libxcb-sync-dev libxcb-sync1 libxcb-xfixes0 libxcb-xfixes0-dev libxcb1-dev libxcomposite1 libxcursor1 libxdamage-dev libxdamage1 libxdmcp-dev libxext-dev libxfixes-dev libxfixes3 libxi-dev libxi6 libxinerama1 libxmu6 libxrandr2 libxrender1 libxshmfence-dev libxshmfence1 libxt6 libxv1 libxvidcore4 libxxf86vm-dev libxxf86vm1 libyaml-cpp0.3v5 libzmq5 libzvbi-common libzvbi0 man-db mesa-common-dev pkg-config po-debconf uuid-dev x11-common x11proto-core-dev x11proto-damage-dev x11proto-dri2-dev x11proto-fixes-dev x11proto-gl-dev x11proto-input-dev x11proto-kb-dev x11proto-xext-dev x11proto-xf86vidmode-dev xorg-sgml-doctools xtrans-dev zlib1g-dev # dh-python libpython3-dev libpython3.5-dev libpython3-stdlib  python3 python3-chardet python3-dev python3-minimal python3-pkg-resources python3-requests python3-six python3-urllib3 python3.5 python3.5-dev python3.5-minimal
# build_files/build_environment/install_deps.sh --with-all --skip-osl # this actually should work on Fedora, but NOT on debian

make bpy